\section{Introduction}
 
The face has been traditionally used in identity documents for visual recognition of a person and therefore represents one of the most used physical traits for biometric recognition \citep{ferrara2012face}. It also has an essential role in many other biometric-related applications such as video surveillance \citep{de2015partially} or facial expression recognition \citep{anil2016literature}. Compared to other physical traits, the face has some advantages. For instance, acquiring facial features via digital photography is non-intrusive, can be performed remotely, and does not require full cooperation from individuals or specialized hardware.
 
In the context of biometric recognition via identity documents, many efforts have been made over the years to allow machine-assisted verification of an individual's identity. One of the most important projects was developed by the \acf{icao}. In 2002, the \acs{icao} defined directives for automatic biometric recognition of people using machines \citep{icao2003report}. The goal was to specify the ideal conditions of facial images to perform robust and highly accurate face verification/recognition by machines. These regulations are followed by many countries worldwide, including, for instance, all member states of the European Union \citep{ebinger2008international}.
 
The \icao \citep{iso-iec} is an official standard that defines the requirements for facial photography used in electronic passports based on the \acs{icao} guidelines. It describes a set of quality rules that include photographic properties (positioning, camera focus, etc.), scene constraints (lighting, pose, and expression), and digital attributes (image resolution, image size, etc.). For example, a given facial image suitable for passports must have a frontal pose with a neutral expression, open eyes, no objects covering the face (e.g., hair or veil), a uniform background, illumination, and focus.
 
Since the number of requirements defined by the ISO/ICAO standards is high (almost 30), the compliance verification of a single face image is still challenging. According to \cite{ferrara2012multi}, this task is still visually performed by human experts, sometimes with the support of an automated system. It prevents agility in critical scenarios, such as international airports, where this task is performed millions of times daily. Therefore, the complete automation of this task is still an ongoing request and may help avoid the need for a human expert and accelerate the document production process. In this context, the following question arises: ``would it be possible to conceive a single Machine Algorithm that could efficiently (in terms of memory and running time) and precisely (with low error rates) assess all the requirements of \icao standard''?
 
In recent years, \acfp{dnn} have gained prominence in Computer Science due to their high propensity to recognize intricate patterns. One of the main advantages of this technique is the network's inherent ability to extract information from raw data, sometimes with little or no preprocessing. It allows a generic learning process that does not depend on attributes explicitly chosen or extracted from the data. In Computer Vision, this task is usually performed by \acfp{cnn}, a particular type of architecture initially developed for images as input, reducing the number of parameters and improving the training process \citep{goodfellow2016deep}.
 
In \acf{ml}, a model is commonly optimized regarding a single metric, usually a score on a specific benchmark. To achieve this, single models or an ensemble of models are often trained for the desired task and fine-tuned until performance plateaus. Although this approach can yield acceptable results in a single task, it neglects information that might potentially improve performance on the primary metric of interest. In particular, such information originates from the training signals of related tasks. The shared representation between related tasks can enable a model to generalize better for the original task \citep{ruder2017overview}. This approach is referred to as \acf{mtl}.
 
\acl{mtl} is a specific \acl{ml} technique that allows multiple tasks to be solved at the same time by exploring familiar and different aspects between them \citep{zhang2017survey}. It goes against the traditional methodology in which one task is learned at a time. Usually, significant problems - such as the ICAO requirements - are broken into small, independent, and reasonably sized subproblems that are solved separately and then recombined. As stated in \cite{Caruana1997}, this approach is sometimes counterproductive since a potentially rich source of information available in many real-world problems is ignored: the information contained in other tasks from the same domain. In the context of \acl{dl}, the \acs{mtl} can allow the network to share information on related tasks to improve generalization in all tasks. Moreover, the \acl{mtl} is best suited when there are limited training samples in multiple related tasks.
 
Compared to the case where each task of a multitasking problem is solved individually by a specific network, the multitask networks present several advantages. First, the number of parameters and memory used by the model is considerably reduced owing to the inherent layer sharing. Second, the inference speed increases because such networks avoid recomputing features in the shared layers. Finally, such networks can improve performance if related tasks share complementary information or act as regularizers for one another \citep{vandenhende2021multi}. In the context of the \icao standard, \acs{mtl} has the potential to solve all requirements in parallel, reducing the processing time and increasing success rates.
 
In this thesis, we present a Deep Learning-based method for the automatic evaluation of the requirements of the \icao standard, called \methodname. Our network was trained from scratch in a Multitask Learning approach with limited data (approximately 5700 images only). The architecture is based on Autoencoders, but the training is performed simultaneously in unsupervised (image reconstruction) and supervised (multi-label classification and landmark localization) manners. An experimental evaluation showed that our method outperformed the algorithms presented in the literature and SDK tools available as commercial solutions on most requirements. We also applied \acf{shap} \citep{shap2018}, \acf{pca} \citep{pca}, and t-SNE \citep{tsne} to understand the representations and predictions related to each requirement presented in the \icao standard.
 
To summarize, the main contributions of this thesis are as follows:
\begin{enumerate}
\item To the best of our knowledge, this is the first work that employs a \acl{mtl} approach for assessment of the \icao requirements.
 
\item We present the first Deep Learning-based work that evaluates all photographic requirements in a single method. All other published studies apply specific methods for each requirement assessment separately or evaluate only a subset of requirements.
 
\item Our method achieved state-of-the-art results in 9 out of the 23 photographic requirements of the \icao standard, being the method with the majority of best results.
 
\item We extended undercomplete Autoencoders to employ a multi-and-collaborative learning approach, where supervised and unsupervised learning are performed concurrently and collaboratively.
\end{enumerate}
 
\subsection{Objectives}	
 
The general objective of this thesis is to develop a state-of-the-art method for assessment of the requirements from \icao standard using \acl{mtl}. By state-of-the-art, we mean an algorithm that can assess all 23 requirements in a single method with the best median \acs{eer} among all the published works. The specific goals are:
 
\begin{itemize}
\item Build an ad-hoc labeled database for evaluation of ICAO requirements;
\item Propose a method to perform preprocessing of face images such that the network can have accurate results without compromising run time speed;
\item Investigate and develop a method for localization of eyes centers;
\item Research and develop a single method for assessment of all photographic and pose-specific tests of \icao standard using \acf{mtl} and compare it against all methods published in the literature; and
\item Analyse the representations learned by the proposed method and its outputs using dimensionality reduction and explanation techniques.
\end{itemize}
 
\subsection{Thesis Structure}
 
The rest of this thesis is structured as follows. First, we detail the fundamental concepts used in this work in Chapter \ref{sec:background}. In Chapter \ref{sec:literature}, a review of the principal \acl{mtl} architectures and works published for the \icao standard is presented. Next, in Chapter \ref{sec:method}, we describe the proposed methodology. The results of the current thesis are presented in Chapter \ref{sec:results}. Finally, the conclusions and possible future research are discussed.
 